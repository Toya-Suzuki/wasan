# This script takes a list of image paths as arguments and
# outputs the class label for each image.
# The script loads a model from files "model_architecture.json"
# and "model_weights.h5", so these files must be present in the
# same folder as the script before running it.

# Usage example:
# classify.py 1.png 2.png folder/3.png

# Example output for the above example:
# 1.png kanji_label_7
# 2.png kanji_label_14
# folder/3.png kanji_label_2

# The output may be preceeded by some statements regarding
# tensorflow or theano usage status depending on which backend is used.

import sys
import numpy as np
from scipy import misc
from keras.models import model_from_json
from keras.optimizers import Adam

# this shortcut will generate all the class names as they were given
#class_names = ["B0"+hex(a)[-2:].upper() for a in range(161, 255)]
#class_names += ["B1"+hex(a)[-2:].upper() for a in range(161, 167)]

#class_names=['14414','14416','14430','14433','14437','14444','14445','14446','14450','14453','14455','14456','14457','14458','14460','14461','14462','14625','14631','14633','14636','14637','14639','14651','14653','14657','14660','14668','14669','14674','14676','14678','14683','14690','14694','14695'
#,'14704','14705','14706','14709','14883','14892','14894','14904','14905','14906','14918','14919','14922','14925','14926','14929','14930','14935','14937','14938','14941','14943','14944','14945','14946','14948','14958','14962','14966','14974','15137','15142','15144','15152','15154','15155'
#,'15158','15162','15163','15165','15167','15168','15172','15173','15176','15178','15179','15181','15182','15183','15184','15186','15188','15189','15190','15191','15192','15193','15199','15200','15201','15204','15205','15206','15210','15211','15212','15213','15214','15217','15221','15222'
#,'15223','15225','15226','15227','15229','15230','15393','15395','15400','15402','15403','15405','15408','15409','15415','15418','15420','15425','15426','15435','15436','15442','15444','15445','15446','15450','15457','15461','15463','15464','15465','15466','15471','15474','15475','15477'
#,'15480','15483','15485','15486','15649','15650','15651','15652','15654','15657','15658','15660','15664','15669','15672','15675','15677','15678','15685','15689','15691','15696','15697','15698','15701','15712','15715','15719','15720','15721','15722','15723','15729','15732','15733','15735'
#,'15736','15740','15905','15910','15911','15918','15919','15925','15927','15932','15939','15942','15944','15946','15950','15951','15962','15965','15966','15973','15976','15980','15983','15984','15986','15989','16162','16165','16166','16167','16169','16174','16180','16183','16185','16188'
#,'16189','16191','16192','16195','16198','16200','16202','16205','16206','16222','16228','16229','16244','16420','16423','16425','16426','16429','16430','16431','16432','16433','16434','16437','16438','16440','16442','16443','16444','16445','16446','16447','16452','16453','16455','16458'
#,'16464','16465','16467','16469','16470','16474','16476','16478','16479','16481','16482','16483','16484','16485','16488','16489','16491','16492','16494','16495','16501','16510','16677','16682','16684','16688','16689','16691','16692','16708','16711','16712','16719','16722','16731','16737'
#,'16744','16746','16749','16752','16758','16759','16764','16765','16930','16932','16934','16935','16937','16940','16941','16942','16943','16944','16946','16947','16948','16952','16953','16954','16955','16956','16958','16959','16960','16967','16974','16976']

class_names=['12321','12322','12323','12324','12325','12326','12327','12328','12329','12330','12331','12332','12333','12334','12335','12336','12337','12338','12339','12340','12341','12342','12343','12344','12345','12346','12347','12348','12349','12350','12351','12352','12353','12354','12355','12356','12357','12358','12359','12360','12361','12362','12363','12364','12365','12366','12367','12368','12369','12370','12371','12372','12373','12374','12375','12376','12377','12378','12379','12380','12381','12382','12383','12384','12385','12386','12387','12388','12389','12390','12391','12392','12393','12394','12395','12396','12397','12398','12399','12400','12401','12402','12403','12404','12405','12406','12407','12408','12409','12410','12411','12412','12413','12414','12577','12578','12579','12580','12581','12582','12583','12584','12585','12586','12587','12588','12589','12590','12591','12592','12593','12594','12595','12596','12597','12598','12599','12600','12601','12602','12603','12604','12605','12606','12607','12608','12609','12610','12611','12612','12613','12614','12615','12616','12617','12618','12619','12620','12621','12622','12623','12624','12625','12626','12627','12628','12629','12630','12631','12632','12633','12634','12635','12636','12637','12638','12639','12640','12641','12642','12643','12644','12645','12646','12647','12648','12649','12650','12651','12652','12653','12654','12655','12656','12657','12658','12659','12660','12661','12662','12663','12664','12665','12666','12667','12668','12669','12670','12833','12834','12835','12836','12837','12838','12839','12840','12841','12842','12843','12844','12845','12846','12847','12848','12849','12850','12851','12852','12853','12854','12855','12856','12857','12858','12859','12860','12861','12862','12863','12864','12865','12866','12867','12868','12869','12870','12871','12872','12873','12874','12875','12876','12877','12878','12879','12880','12881','12882','12883','12884','12885','12886','12887','12888','12889','12890','12891','12892','12893','12894','12895','12896','12897','12898','12899','12900','12901','12902','12903','12904','12905','12906','12907','12908','12909','12910','12911','12912','12913','12914','12915','12916','12917','12918','12919','12920','12921','12922','12923','12924','12925','12926','13089','13090','13091','13092','13093','13094','13095','13096','13097','13098','13099','13100','13101','13102','13103','13104','13105','13106','13107','13108','13109','13110','13111','13112','13113','13114','13115','13116','13117','13118','13119','13120','13121','13122','13123','13124','13125','13126','13127','13128','13129','13130','13131','13132','13133','13134','13135','13136','13137','13138','13139','13140','13141','13142','13143','13144','13145','13146','13147','13148','13149','13150','13151','13152','13153','13154','13155','13156','13157','13158','13159','13160','13161','13162','13163','13164','13165','13166','13167','13168','13169','13170','13171','13172','13173','13174','13175','13176','13177','13178','13179','13180','13181','13182','13345','13346','13347','13348','13349','13350','13351','13352','13353','13354','13355','13356','13357','13358','13359','13360','13361','13362','13363','13364','13365','13366','13367','13368','13369','13370','13371','13372','13373','13374','13375','13376','13377','13378','13379','13380','13381','13382','13383','13384','13385','13386','13387','13388','13389','13390','13391','13392','13393','13394','13395','13396','13397','13398','13399','13400','13401','13402','13403','13404','13405','13406','13407','13408','13409','13410','13411','13412','13413','13414','13415','13416','13417','13418','13419','13420','13421','13422','13423','13424','13425','13426','13427','13428','13429','13430','13431','13432','13433','13434','13435','13436','13437','13438','13601','13602','13603','13604','13605','13606','13607','13608','13609','13610','13611','13612','13613','13614','13615','13616','13617','13618','13619','13620','13621','13622','13623','13624','13625','13626','13627','13628','13629','13630','13631','13632','13633','13634','13635','13636','13637','13638','13639','13640','13641','13642','13643','13644','13645','13646','13647','13648','13649','13650','13651','13652','13653','13654','13655','13656','13657','13658','13659','13660','13661','13662','13663','13664','13665','13666','13667','13668','13669','13670','13671','13672','13673','13674','13675','13676','13677','13678','13679','13680','13681','13682','13683','13684','13685','13686','13687','13688','13689','13690','13691','13692','13693','13694','13857','13858','13859','13860','13861','13862','13863','13864','13865','13866','13867','13868','13869','13870','13871','13872','13873','13874','13875','13876','13877','13878','13879','13880','13881','13882','13883','13884','13885','13886','13887','13888','13889','13890','13891','13892','13893','13894','13895','13896','13897','13898','13899','13900','13901','13902','13903','13904','13905','13906','13907','13908','13909','13910','13911','13912','13913','13914','13915','13916','13917','13918','13919','13920','13921','13922','13923','13924','13925','13926','13927','13928','13929','13930','13931','13932','13933','13934','13935','13936','13937','13938','13939','13940','13941','13942','13943','13944','13945','13946','13947','13948','13949','13950','14113','14114','14115','14116','14117','14118','14119','14120','14121','14122','14123','14124','14125','14126','14127','14128','14129','14130','14131','14132','14133','14134','14135','14136','14137','14138','14139','14140','14141','14142','14143','14144','14145','14146','14147','14148','14149','14150','14151','14152','14153','14154','14155','14156','14157','14158','14159','14160','14161','14162','14163','14164','14165','14166','14167','14168','14169','14170','14171','14172','14173','14174','14175','14176','14177','14178','14179','14180','14181','14182','14183','14184','14185','14186','14187','14188','14189','14190','14191','14192','14193','14194','14195','14196','14197','14198','14199','14200','14201','14202','14203','14204','14205','14206','14369','14370','14371','14372','14373','14374','14375','14376','14377','14378','14379','14380','14381','14382','14383','14384','14385','14386','14387','14388','14389','14390','14391','14392','14393','14394','14395','14396','14397','14398','14399','14400','14401','14402','14403','14404','14405','14406','14407','14408','14409','14410','14411','14412','14413','14414','14415','14416','14417','14418','14419','14420','14421','14422','14423','14424','14425','14426','14427','14428','14429','14430','14431','14432','14433','14434','14435','14436','14437','14438','14439','14440','14441','14442','14443','14444','14445','14446','14447','14448','14449','14450','14451','14452','14453','14454','14455','14456','14457','14458','14459','14460','14461','14462','14625','14626','14627','14628','14629','14630','14631','14632','14633','14634','14635','14636','14637','14638','14639','14640','14641','14642','14643','14644','14645','14646','14647','14648','14649','14650','14651','14652','14653','14654','14655','14656','14657','14658','14659','14660','14661','14662','14663','14664','14665','14666','14667','14668','14669','14670','14671','14672','14673','14674','14675','14676','14677','14678','14679','14680','14681','14682','14683','14684','14685','14686','14687','14688','14689','14690','14691','14692','14693','14694','14695','14696','14697','14698','14699','14700','14701','14702','14703','14704','14705','14706','14707','14708','14709','14710','14711','14712','14713','14714','14715','14716','14717','14718','14881','14882','14883','14884','14885','14886','14887','14888','14889','14890','14891','14892','14893','14894','14895','14896','14897','14898','14899','14900','14901','14902','14903','14904','14905','14906','14907','14908','14909','14910','14911','14912','14913','14914','14915','14916','14917','14918','14919','14920','14921','14922','14923','14924','14925','14926','14927','14928','14929','14930','14931','14932','14933','14934','14935','14936','14937','14938','14939','14940','14941','14942','14943','14944','14945','14946','14947','14948','14949','14950','14951','14952','14953','14954','14955','14956','14957','14958','14959','14960','14961','14962','14963','14964','14965','14966','14967','14968','14969','14970','14971','14972','14973','14974','15137','15138','15139','15140','15141','15142','15143','15144','15145','15146','15147','15148','15149','15150','15151','15152','15153','15154','15155','15156','15157','15158','15159','15160','15161','15162','15163','15164','15165','15166','15167','15168','15169','15170','15171','15172','15173','15174','15175','15176','15177','15178','15179','15180','15181','15182','15183','15184','15185','15186','15187','15188','15189','15190','15191','15192','15193','15194','15195','15196','15197','15198','15199','15200','15201','15202','15203','15204','15205','15206','15207','15208','15209','15210','15211','15212','15213','15214','15215','15216','15217','15218','15219','15220','15221','15222','15223','15224','15225','15226','15227','15228','15229','15230','15393','15394','15395','15396','15397','15398','15399','15400','15401','15402','15403','15404','15405','15406','15407','15408','15409','15410','15411','15412','15413','15414','15415','15416','15417','15418','15419','15420','15421','15422','15423','15424','15425','15426','15427','15428','15429','15430','15431','15432','15433','15434','15435','15436','15437','15438','15439','15440','15441','15442','15443','15444','15445','15446','15447','15448','15449','15450','15451','15452','15453','15454','15455','15456','15457','15458','15459','15460','15461','15462','15463','15464','15465','15466','15467','15468','15469','15470','15471','15472','15473','15474','15475','15476','15477','15478','15479','15480','15481','15482','15483','15484','15485','15486','15649','15650','15651','15652','15653','15654','15655','15656','15657','15658','15659','15660','15661','15662','15663','15664','15665','15666','15667','15668','15669','15670','15671','15672','15673','15674','15675','15676','15677','15678','15679','15680','15681','15682','15683','15684','15685','15686','15687','15688','15689','15690','15691','15692','15693','15694','15695','15696','15697','15698','15699','15700','15701','15702','15703','15704','15705','15706','15707','15708','15709','15710','15711','15712','15713','15714','15715','15716','15717','15718','15719','15720','15721','15722','15723','15724','15725','15726','15727','15728','15729','15730','15731','15732','15733','15734','15735','15736','15737','15738','15739','15740','15741','15742','15905','15906','15907','15908','15909','15910','15911','15912','15913','15914','15915','15916','15917','15918','15919','15920','15921','15922','15923','15924','15925','15926','15927','15928','15929','15930','15931','15932','15933','15934','15935','15936','15937','15938','15939','15940','15941','15942','15943','15944','15945','15946','15947','15948','15949','15950','15951','15952','15953','15954','15955','15956','15957','15958','15959','15960','15961','15962','15963','15964','15965','15966','15967','15968','15969','15970','15971','15972','15973','15974','15975','15976','15977','15978','15979','15980','15981','15982','15983','15984','15985','15986','15987','15988','15989','15990','15991','15992','15993','15994','15995','15996','15997','15998','16161','16162','16163','16164','16165','16166','16167','16168','16169','16170','16171','16172','16173','16174','16175','16176','16177','16178','16179','16180','16181','16182','16183','16184','16185','16186','16187','16188','16189','16190','16191','16192','16193','16194','16195','16196','16197','16198','16199','16200','16201','16202','16203','16204','16205','16206','16207','16208','16209','16210','16211','16212','16213','16214','16215','16216','16217','16218','16219','16220','16221','16222','16223','16224','16225','16226','16227','16228','16229','16230','16231','16232','16233','16234','16235','16236','16237','16238','16239','16240','16241','16242','16243','16244','16245','16246','16247','16248','16249','16250','16251','16252','16253','16254','16417','16418','16419','16420','16421','16422','16423','16424','16425','16426','16427','16428','16429','16430','16431','16432','16433','16434','16435','16436','16437','16438','16439','16440','16441','16442','16443','16444','16445','16446','16447','16448','16449','16450','16451','16452','16453','16454','16455','16456','16457','16458','16459','16460','16461','16462','16463','16464','16465','16466','16467','16468','16469','16470','16471','16472','16473','16474','16475','16476','16477','16478','16479','16480','16481','16482','16483','16484','16485','16486','16487','16488','16489','16490','16491','16492','16493','16494','16495','16496','16497','16498','16499','16500','16501','16502','16503','16504','16505','16506','16507','16508','16509','16510','16673','16674','16675','16676','16677','16678','16679','16680','16681','16682','16683','16684','16685','16686','16687','16688','16689','16690','16691','16692','16693','16694','16695','16696','16697','16698','16699','16700','16701','16702','16703','16704','16705','16706','16707','16708','16709','16710','16711','16712','16713','16714','16715','16716','16717','16718','16719','16720','16721','16722','16723','16724','16725','16726','16727','16728','16729','16730','16731','16732','16733','16734','16735','16736','16737','16738','16739','16740','16741','16742','16743','16744','16745','16746','16747','16748','16749','16750','16751','16752','16753','16754','16755','16756','16757','16758','16759','16760','16761','16762','16763','16764','16765','16766','16929','16930','16931','16932','16933','16934','16935','16936','16937','16938','16939','16940','16941','16942','16943','16944','16945','16946','16947','16948','16949','16950','16951','16952','16953','16954','16955','16956','16957','16958','16959','16960','16961','16962','16963','16964','16965','16966','16967','16968','16969','16970','16971','16972','16973','16974','16975','16976','16977','16978','16979','16980','16981','16982','16983','16984','16985','16986','16987','16988','16989','16990','16991','16992','16993','16994','16995','16996','16997','16998','16999','17000','17001','17002','17003','17004','17005','17006','17007','17008','17009','17010','17011','17012','17013','17014','17015','17016','17017','17018','17019','17020','17021','17022','17185','17186','17187','17188','17189','17190','17191','17192','17193','17194','17195','17196','17197','17198','17199','17200','17201','17202','17203','17204','17205','17206','17207','17208','17209','17210','17211','17212','17213','17214','17215','17216','17217','17218','17219','17220','17221','17222','17223','17224','17225','17226','17227','17228','17229','17230','17231','17232','17233','17234','17235','17236','17237','17238','17239','17240','17241','17242','17243','17244','17245','17246','17247','17248','17249','17250','17251','17252','17253','17254','17255','17256','17257','17258','17259','17260','17261','17262','17263','17264','17265','17266','17267','17268','17269','17270','17271','17272','17273','17274','17275','17276','17277','17278','17441','17442','17443','17444','17445','17446','17447','17448','17449','17450','17451','17452','17453','17454','17455','17456','17457','17458','17459','17460','17461','17462','17463','17464','17465','17466','17467','17468','17469','17470','17471','17472','17473','17474','17475','17476','17477','17478','17479','17480','17481','17482','17483','17484','17485','17486','17487','17488','17489','17490','17491','17492','17493','17494','17495','17496','17497','17498','17499','17500','17501','17502','17503','17504','17505','17506','17507','17508','17509','17510','17511','17512','17513','17514','17515','17516','17517','17518','17519','17520','17521','17522','17523','17524','17525','17526','17527','17528','17529','17530','17531','17532','17533','17534','17697','17698','17699','17700','17701','17702','17703','17704','17705','17706','17707','17708','17709','17710','17711','17712','17713','17714','17715','17716','17717','17718','17719','17720','17721','17722','17723','17724','17725','17726','17727','17728','17729','17730','17731','17732','17733','17734','17735','17736','17737','17738','17739','17740','17741','17742','17743','17744','17745','17746','17747','17748','17749','17750','17751','17752','17753','17754','17755','17756','17757','17758','17759','17760','17761','17762','17763','17764','17765','17766','17767','17768','17769','17770','17771','17772','17773','17774','17775','17776','17777','17778','17779','17780','17781','17782','17783','17784','17785','17786','17787','17788','17789','17790','17953','17954','17955','17956','17957','17958','17959','17960','17961','17962','17963','17964','17965','17966','17967','17968','17969','17970','17971','17972','17973','17974','17975','17976','17977','17978','17979','17980','17981','17982','17983','17984','17985','17986','17987','17988','17989','17990','17991','17992','17993','17994','17995','17996','17997','17998','17999','18000','18001','18002','18003','18004','18005','18006','18007','18008','18009','18010','18011','18012','18013','18014','18015','18016','18017','18018','18019','18020','18021','18022','18023','18024','18025','18026','18027','18028','18029','18030','18031','18032','18033','18034','18035','18036','18037','18038','18039','18040','18041','18042','18043','18044','18045','18046','18209','18210','18211','18212','18213','18214','18215','18216','18217','18218','18219','18220','18221','18222','18223','18224','18225','18226','18227','18228','18229','18230','18231','18232','18233','18234','18235','18236','18237','18238','18239','18240','18241','18242','18243','18244','18245','18246','18247','18248','18249','18250','18251','18252','18253','18254','18255','18256','18257','18258','18259','18260','18261','18262','18263','18264','18265','18266','18267','18268','18269','18270','18271','18272','18273','18274','18275','18276','18277','18278','18279','18280','18281','18282','18283','18284','18285','18286','18287','18288','18289','18290','18291','18292','18293','18294','18295','18296','18297','18298','18299','18300','18301','18302','18465','18466','18467','18468','18469','18470','18471','18472','18473','18474','18475','18476','18477','18478','18479','18480','18481','18482','18483','18484','18485','18486','18487','18488','18489','18490','18491','18492','18493','18494','18495','18496','18497','18498','18499','18500','18501','18502','18503','18504','18505','18506','18507','18508','18509','18510','18511','18512','18513','18514','18515','18516','18517','18518','18519','18520','18521','18522','18523','18524','18525','18526','18527','18528','18529','18530','18531','18532','18533','18534','18535','18536','18537','18538','18539','18540','18541','18542','18543','18544','18545','18546','18547','18548','18549','18550','18551','18552','18553','18554','18555','18556','18557','18558','18721','18722','18723','18724','18725','18726','18727','18728','18729','18730','18731','18732','18733','18734','18735','18736','18737','18738','18739','18740','18741','18742','18743','18744','18745','18746','18747','18748','18749','18750','18751','18752','18753','18754','18755','18756','18757','18758','18759','18760','18761','18762','18763','18764','18765','18766','18767','18768','18769','18770','18771','18772','18773','18774','18775','18776','18777','18778','18779','18780','18781','18782','18783','18784','18785','18786','18787','18788','18789','18790','18791','18792','18793','18794','18795','18796','18797','18798','18799','18800','18801','18802','18803','18804','18805','18806','18807','18808','18809','18810','18811','18812','18813','18814','18977','18978','18979','18980','18981','18982','18983','18984','18985','18986','18987','18988','18989','18990','18991','18992','18993','18994','18995','18996','18997','18998','18999','19000','19001','19002','19003','19004','19005','19006','19007','19008','19009','19010','19011','19012','19013','19014','19015','19016','19017','19018','19019','19020','19021','19022','19023','19024','19025','19026','19027','19028','19029','19030','19031','19032','19033','19034','19035','19036','19037','19038','19039','19040','19041','19042','19043','19044','19045','19046','19047','19048','19049','19050','19051','19052','19053','19054','19055','19056','19057','19058','19059','19060','19061','19062','19063','19064','19065','19066','19067','19068','19069','19070','19233','19234','19235','19236','19237','19238','19239','19240','19241','19242','19243','19244','19245','19246','19247','19248','19249','19250','19251','19252','19253','19254','19255','19256','19257','19258','19259','19260','19261','19262','19263','19264','19265','19266','19267','19268','19269','19270','19271','19272','19273','19274','19275','19276','19277','19278','19279','19280','19281','19282','19283','19284','19285','19286','19287','19288','19289','19290','19291','19292','19293','19294','19295','19296','19297','19298','19299','19300','19301','19302','19303','19304','19305','19306','19307','19308','19309','19310','19311','19312','19313','19314','19315','19316','19317','19318','19319','19320','19321','19322','19323','19324','19325','19326','19489','19490','19491','19492','19493','19494','19495','19496','19497','19498','19499','19500','19501','19502','19503','19504','19505','19506','19507','19508','19509','19510','19511','19512','19513','19514','19515','19516','19517','19518','19519','19520','19521','19522','19523','19524','19525','19526','19527','19528','19529','19530','19531','19532','19533','19534','19535','19536','19537','19538','19539','19540','19541','19542','19543','19544','19545','19546','19547','19548','19549','19550','19551','19552','19553','19554','19555','19556','19557','19558','19559','19560','19561','19562','19563','19564','19565','19566','19567','19568','19569','19570','19571','19572','19573','19574','19575','19576','19577','19578','19579','19580','19581','19582','19745','19746','19747','19748','19749','19750','19751','19752','19753','19754','19755','19756','19757','19758','19759','19760','19761','19762','19763','19764','19765','19766','19767','19768','19769','19770','19771','19772','19773','19774','19775','19776','19777','19778','19779','19780','19781','19782','19783','19784','19785','19786','19787','19788','19789','19790','19791','19792','19793','19794','19795','19796','19797','19798','19799','19800','19801','19802','19803','19804','19805','19806','19807','19808','19809','19810','19811','19812','19813','19814','19815','19816','19817','19818','19819','19820','19821','19822','19823','19824','19825','19826','19827','19828','19829','19830','19831','19832','19833','19834','19835','19836','19837','19838','20001','20002','20003','20004','20005','20006','20007','20008','20009','20010','20011','20012','20013','20014','20015','20016','20017','20018','20019','20020','20021','20022','20023','20024','20025','20026','20027','20028','20029','20030','20031','20032','20033','20034','20035','20036','20037','20038','20039','20040','20041','20042','20043','20044','20045','20046','20047','20048','20049','20050','20051','20052','20053','20054','20055','20056','20057','20058','20059','20060','20061','20062','20063','20064','20065','20066','20067','20068','20069','20070','20071','20072','20073','20074','20075','20076','20077','20078','20079','20080','20081','20082','20083','20084','20085','20086','20087','20088','20089','20090','20091','20092','20093','20094','20257','20258','20259','20260','20261','20262','20263','20264','20265','20266','20267','20268','20269','20270','20271','20272','20273','20274','20275','20276','20277','20278','20279','20280','20281','20282','20283','20284','20285','20286','20287','20288','20289','20290','20291','20292','20293','20294','20295','20296','20297','20298','20299','20300','20301','20302','20303','20304','20305','20306','20307','9250','9252','9254','9256','9258','9259','9260','9261','9262','9263','9264','9265','9266','9267','9268','9269','9270','9271','9272','9273','9274','9275','9276','9277','9278','9279','9280','9281','9282','9284','9285','9286','9287','9288','9289','9290','9291','9292','9293','9294','9295','9296','9297','9298','9299','9300','9301','9302','9303','9304','9305','9306','9307','9308','9309','9310','9311','9312','9313','9314','9316','9318','9320','9321','9322','9323','9324','9325','9327','9330','9331']



print class_names

f = open('model_architecture.json', 'r')
model = model_from_json(f.read())
f.close()

model.load_weights('model_weights.h5')

# SHAPE can also potentially be inferred automatically from the loaded model
SHAPE = (32, 32)

X = []

for image_location in sys.argv[1:]:
    image = misc.imread(image_location)
    image = misc.imresize(image, size=SHAPE, interp='bilinear', mode=None)
    X.append(image)

X = np.float32(np.array(X)/255.0)
X = np.reshape(X, (len(X), 1, SHAPE[0], SHAPE[1]))

adam = Adam()
model.compile(loss='categorical_crossentropy', optimizer=adam,  metrics=['accuracy'])

predicted_classes = model.predict_classes(X, batch_size=1, verbose=1)

for i, predicted_class in enumerate(predicted_classes):
    print sys.argv[i+1], class_names[predicted_class]
